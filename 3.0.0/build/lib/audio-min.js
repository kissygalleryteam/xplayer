KISSY.add("kg/xplayer/3.0.0/lib/audio",["base","./status"],function(t,s,i,a){var e=s("base"),u=s("./status"),n=e.extend({initializer:function(){var t=this;t.audio=new Audio,t.audio.preload=!0,t._addEvent(),t.status=u},_addEvent:function(){var s=this;s.audio.addEventListener("loadstart",function(i){t.log("Xplayer open"),s.fire("open")}),s.audio.addEventListener("timeupdate",function(t){s.status.currentTime=1e3*this.currentTime,s.status.duration=1e3*this.duration,s.fire(t.type,s.status)}),s.audio.addEventListener("ended",function(t){s.status.isPlaying=!1,s.status.isPaused=!1,s.fire(t.type)}),s.audio.addEventListener("progress",function(t){if(null!=s.audio.buffered&&s.audio.buffered.length){var i=s.audio.buffered.end(s.audio.buffered.length-1);s.fire(t.type,{progress:1e3*i,duration:1e3*s.audio.duration})}}),s.audio.addEventListener("error",function(t){s.fire(t.type)})},load:function(t){var s=this;s.set("src",t),s.audio.src=t,s.audio.volume=s.get("volume")},play:function(){var s=this;t.log(s.status.isPlaying),s.status.isPlaying||(s.status.isPlaying=!0,s.status.isPaused=!1,s.audio.play())},pause:function(){var t=this;t.status.isPaused||(t.status.isPlaying=!1,t.status.isPaused=!0,t.status.pausePosition=t.audio.currentTime,t.audio.pause())},stop:function(){var t=this;t.status.isPlaying=!1,t.status.isPaused=!1,t.status.pausePosition=0;try{t.audio.currentTime=0}catch(s){}t.audio.pause()},setPosition:function(t){var s=this;s.audio.readyState>0&&(s.status.currentTime=t/1e3,s.audio.currentTime=s.status.currentTime,s.status.pausePosition=t),s.status.isPlaying||s.play()},setVolume:function(t){var s=this;s.status.volume=t,s.set("volume",t)}},{ATTRS:{volume:{value:.5,setter:function(t){return this.audio.volume=t,t},validator:function(s){return 1>=s&&s>=0&&t.isNumber(s)?!0:!1}},src:{}}});a.exports=n});